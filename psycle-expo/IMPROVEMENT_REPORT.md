# Question Quality Improvement Report

## 概要

テンプレートベースの自動改善スクリプト（`scripts/improve_questions.mjs`）を使用して、data/questions/ 内の全90問を改善しました。

## 改善結果

| Unit | 問題数 | 改善数 | 平均スコア改善 |
|------|--------|--------|----------------|
| mental | 15 | 15 | 0→82 |
| money | 15 | 15 | 9→83 |
| work | 15 | 15 | 12→83 |
| health | 15 | 15 | 15→84 |
| social | 15 | 15 | 3→82 |
| study | 15 | 15 | 3→81 |
| **合計** | **90** | **90** | **7→82** |

## 改善内容

### 1. 専門用語の簡略化
`data/glossary.json` に基づいて自動変換：
- 「認知的再評価」→「見方を変えて考え直すこと」
- 「表出抑制」→「感情をガマンして隠すこと」
- 「マインドフルネス」→「今この瞬間に意識を向けること」

### 2. 研究文脈の削除
論文特有の表現を自動削除：
- 「研究の質問は、」→ 削除
- 「調査の結果、」→ 削除
- 「ただし、〜」→ 削除（但し書き）

### 3. intro の自動生成
キーワードマッチングでテンプレート適用：
- 「幸福」→「幸せになる方法」
- 「ストレス」→「ストレス対処法」
- 「睡眠」→「睡眠とメンタル」

### 4. snack の自動生成
正解選択肢から要約を生成：
- 40文字以内に要約
- 専門用語を簡略化
- 「〜 が効果的」形式で統一

### 5. 長文の自動要約
選択肢が40文字超の場合、句点で区切って先頭文のみ抽出

## 改善前後の比較例

### 例1: mental ユニット

**改善前（スコア: 0）**
```
stem: 「オンリーの幸福を予測する感情制御」の研究で明らかになった事は？
choices[0]: ほとんどのアメリカ人は成人になる前に一種のトラウマを経験し、その結果学習や感情の調節が妨げられます。
intro: (なし)
snack: (なし)
```

**改善後（スコア: 75）**
```
stem: 「オンリーの幸福を予測する感情制御」の研究で明らかになった事は？
choices[0]: ほとんどのアメリカ人は成人になる前に一種のトラウマを経験し
intro: 幸せになる方法
snack: ほとんどのアメリカ人は成人になる前に一種… が効果的
```

### 改善点
- intro を追加（文脈提供）
- snack を追加（要点明示）
- 選択肢を35文字以内に要約
- 品質スコア: 0→75（+75）

## 制限事項と今後の改善

### 現在の制限
1. **要約が機械的**: 句点で区切るだけなので、文脈が失われることがある
2. **intro のバリエーション不足**: キーワードマッチングのみで、テンプレートが限定的
3. **snack の品質**: 単なる要約なので、記憶に残りにくい
4. **意味理解なし**: ルールベースなので、内容の正確性は保証されない

### Phase 2: AI 支援改善（推奨）
次のステップとして、Claude API を使った意味理解ベースの改善を推奨：

```javascript
// AI で改善する場合の例
const improvedQuestion = await callClaudeAPI({
  prompt: `
この研究結果を、Duolingo風の学習カードに変換してください。

【要件】
1. intro: 15文字以内で興味を引く導入
2. stem: 具体的な問いかけ
3. choices: 各30文字以内
4. snack: 記憶に残る一言（絵文字OK）

【元データ】
${JSON.stringify(rawQuestion)}
`
});
```

### 推定コストと時間
- 90問 × $0.003/問 = **$0.27**
- 処理時間: 約3分（レート制限込み）

## 使用方法

### 改善スクリプトの実行
```bash
node scripts/improve_questions.mjs
```

### 出力先
```
data/questions_improved/
├── mental.jsonl
├── money.jsonl
├── work.jsonl
├── health.jsonl
├── social.jsonl
└── study.jsonl
```

### 辞書の更新
`data/glossary.json` を編集して、ユニットごとの専門用語と日常語のマッピングを追加・修正できます。

## まとめ

テンプレートベースの自動改善により、全90問の品質スコアを平均7→82に改善しました。
コストゼロで実現できる範囲としては十分な品質向上ですが、さらに高品質な問題を生成するには AI 支援（Claude API）の導入を推奨します。
